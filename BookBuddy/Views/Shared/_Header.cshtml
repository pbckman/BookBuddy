@model IPageViewModel<SitePageData>
@inject ProfileService ProfileService
@inject UserManager<ApplicationUser> _userManager

@{
    var user = await _userManager.GetUserAsync(User);
    var userId = user?.Id;
    var profiles = await ProfileService.GetAllProfilesAsync(userId);
    var mainProfile = await ProfileService.GetMainProfilesAsync(user);
}

@if (User != null)
{
    <div class="header-wrapper">
    <div class="header-items">
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon">
                    <i class="fa-solid fa-bars"></i>
                </span>
        </button>

            <div class="dropdown">
                @if (User.Identity.IsAuthenticated)
                {
                    <button class="btn btn-light dropdown-toggle d-flex align-items-center" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <img class="profile-image" src="~/images/default-profile.jpg" alt="Company Logo" /> <span class="d-none d-lg-block">@mainProfile.ProfileFirstName</span>
                    </button>

                    <ul class="dropdown-menu">
                        @foreach (var profile in profiles)
                        {
                            <li><a class="dropdown-item" href="#">@profile.ProfileFirstName</a></li>
                        }
                    </ul>
                }
                else
                {
                    <form action="@Url.Action("SignIn", "Auth")" >
                        @Html.AntiForgeryToken()
                        <button class="btn btn-light header-signin d-flex align-items-center" type="submit" aria-expanded="false">
                            <img class="profile-image" src="~/images/default-profile.jpg" alt="Company Logo" /> <span class="d-none d-lg-block">Sign in</span>
                        </button>
                    </form>
                    
                }
            </div>
   
    </div>
</div>
}
